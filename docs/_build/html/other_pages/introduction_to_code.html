<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="index" title="Index" href="../genindex.html"/>
    <link rel="search" title="Search" href="../search.html"/>
    <link rel="next" title="Contributing guidelines" href="contributing_guidelines.html"/>
    <link rel="prev" title="Understanding the ajmc directory structure." href="data_organisation.html"/>

    <!-- Generated with Sphinx 7.2.5 and Furo 2023.08.19 -->
    <title>Understanding the goal of the library - ajmc v0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c"/>
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be"/>
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c"/>


    <style>
        body {
            --color-code-background: #f8f8f8;
            --color-code-foreground: black;

        }

        @media not print {
            body[data-theme="dark"] {
                --color-code-background: #202020;
                --color-code-foreground: #d0d0d0;

            }

            @media (prefers-color-scheme: dark) {
                body:not([data-theme="light"]) {
                    --color-code-background: #202020;
                    --color-code-foreground: #d0d0d0;

                }
            }
        }
    </style>
</head>
<body>

<script>
    document.body.dataset.theme = localStorage.getItem("theme") || "auto";
</script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-toc" viewBox="0 0 24 24">
        <title>Contents</title>
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
            <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-sun" viewBox="0 0 24 24">
        <title>Light mode</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
    </symbol>
    <symbol id="svg-moon" viewBox="0 0 24 24">
        <title>Dark mode</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/>
        </svg>
    </symbol>
    <symbol id="svg-sun-half" viewBox="0 0 24 24">
        <title>Auto light/dark mode</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="12" r="9"/>
            <path d="M13 12h5"/>
            <path d="M13 15h4"/>
            <path d="M13 18h1"/>
            <path d="M13 9h4"/>
            <path d="M13 6h1"/>
        </svg>
    </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="../index.html">
                <div class="brand">ajmc v0.0.1 documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer">
        <div class="sidebar-container">

            <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">


                <span class="sidebar-brand-text">ajmc v0.0.1 documentation</span>

            </a>
                <form class="sidebar-search-container" method="get" action="../search.html" role="search">
                    <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
                    <input type="hidden" name="check_keywords" value="yes">
                    <input type="hidden" name="area" value="default">
                </form>
                <div id="searchbox"></div>
                <div class="sidebar-scroll">
                    <div class="sidebar-tree">
                        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
                        <ul>
                            <li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">ajmc</a><input
                                    class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1"
                                    role="switch" type="checkbox"/><label for="toctree-checkbox-1">
                                <div class="visually-hidden">Toggle navigation of ajmc</div>
                                <i class="icon">
                                    <svg>
                                        <use href="#svg-arrow-right"></use>
                                    </svg>
                                </i></label>
                                <ul>
                                    <li class="toctree-l2 has-children"><a class="reference internal"
                                                                           href="../ajmc.html">ajmc package</a><input
                                            class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2"
                                            role="switch" type="checkbox"/><label for="toctree-checkbox-2">
                                        <div class="visually-hidden">Toggle navigation of ajmc package</div>
                                        <i class="icon">
                                            <svg>
                                                <use href="#svg-arrow-right"></use>
                                            </svg>
                                        </i></label>
                                        <ul>
                                            <li class="toctree-l3"><a class="reference internal"
                                                                      href="../ajmc.commons.html">ajmc.commons
                                                package</a></li>
                                            <li class="toctree-l3"><a class="reference internal"
                                                                      href="../ajmc.corpora.html">ajmc.corpora
                                                package</a></li>
                                            <li class="toctree-l3 has-children"><a class="reference internal"
                                                                                   href="../ajmc.nlp.html">ajmc.nlp
                                                package</a><input class="toctree-checkbox" id="toctree-checkbox-3"
                                                                  name="toctree-checkbox-3" role="switch"
                                                                  type="checkbox"/><label for="toctree-checkbox-3">
                                                <div class="visually-hidden">Toggle navigation of ajmc.nlp package</div>
                                                <i class="icon">
                                                    <svg>
                                                        <use href="#svg-arrow-right"></use>
                                                    </svg>
                                                </i></label>
                                                <ul>
                                                    <li class="toctree-l4 has-children"><a class="reference internal"
                                                                                           href="../ajmc.nlp.token_classification.html">ajmc.nlp.token_classification
                                                        package</a><input class="toctree-checkbox"
                                                                          id="toctree-checkbox-4"
                                                                          name="toctree-checkbox-4" role="switch"
                                                                          type="checkbox"/><label
                                                            for="toctree-checkbox-4">
                                                        <div class="visually-hidden">Toggle navigation of
                                                            ajmc.nlp.token_classification package
                                                        </div>
                                                        <i class="icon">
                                                            <svg>
                                                                <use href="#svg-arrow-right"></use>
                                                            </svg>
                                                        </i></label>
                                                        <ul>
                                                            <li class="toctree-l5"><a class="reference internal"
                                                                                      href="../ajmc.nlp.token_classification.data_preparation.html">ajmc.nlp.token_classification.data_preparation
                                                                package</a></li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="toctree-l3 has-children"><a class="reference internal"
                                                                                   href="../ajmc.ocr.html">ajmc.ocr
                                                package</a><input class="toctree-checkbox" id="toctree-checkbox-5"
                                                                  name="toctree-checkbox-5" role="switch"
                                                                  type="checkbox"/><label for="toctree-checkbox-5">
                                                <div class="visually-hidden">Toggle navigation of ajmc.ocr package</div>
                                                <i class="icon">
                                                    <svg>
                                                        <use href="#svg-arrow-right"></use>
                                                    </svg>
                                                </i></label>
                                                <ul>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="../ajmc.ocr.preprocessing.html">ajmc.ocr.preprocessing
                                                        package</a></li>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="../ajmc.ocr.pytorch.html">ajmc.ocr.pytorch
                                                        package</a></li>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="../ajmc.ocr.tesseract.html">ajmc.ocr.tesseract
                                                        package</a></li>
                                                </ul>
                                            </li>
                                            <li class="toctree-l3 has-children"><a class="reference internal"
                                                                                   href="../ajmc.olr.html">ajmc.olr
                                                package</a><input class="toctree-checkbox" id="toctree-checkbox-6"
                                                                  name="toctree-checkbox-6" role="switch"
                                                                  type="checkbox"/><label for="toctree-checkbox-6">
                                                <div class="visually-hidden">Toggle navigation of ajmc.olr package</div>
                                                <i class="icon">
                                                    <svg>
                                                        <use href="#svg-arrow-right"></use>
                                                    </svg>
                                                </i></label>
                                                <ul>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="../ajmc.olr.layoutlm.html">ajmc.olr.layoutlm
                                                        package</a></li>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="../ajmc.olr.yolo.html">ajmc.olr.yolo
                                                        package</a></li>
                                                </ul>
                                            </li>
                                            <li class="toctree-l3"><a class="reference internal"
                                                                      href="../ajmc.text_processing.html">ajmc.text_processing
                                                package</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <p class="caption" role="heading"><span class="caption-text">Introduction:</span></p>
                        <ul>
                            <li class="toctree-l1"><a class="reference internal" href="base_functionalities.html">Basic
                                functionalities</a></li>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="commentary_importation_pipeline.html">Commentary importation
                                pipeline</a></li>
                            <li class="toctree-l1"><a class="reference internal" href="data_organisation.html">Understanding
                                the ajmc directory structure.</a></li>
                        </ul>
                        <p class="caption" role="heading"><span class="caption-text">Contributing:</span></p>
                        <ul class="current">
                            <li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Understanding
                                the goal of the library</a></li>
                            <li class="toctree-l1"><a class="reference internal" href="#The-commons-directory">The
                                commons directory</a></li>
                            <li class="toctree-l1"><a class="reference internal" href="#The-text_processing-directory">The
                                <code class="docutils literal notranslate"><span
                                        class="pre">text_processing</span></code> directory</a></li>
                            <li class="toctree-l1"><a class="reference internal" href="contributing_guidelines.html">Contributing
                                guidelines</a></li>
                        </ul>

                    </div>
                </div>

            </div>

        </div>
    </aside>
    <div class="main">
        <div class="content">
            <div class="article-container">
                <a href="#" class="back-to-top muted-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
                    </svg>
                    <span>Back to top</span>
                </a>
                <div class="content-icon-container">

                    <div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon" for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <article role="main">
                    <section id="Understanding-the-goal-of-the-library">
                        <h1>Understanding the goal of the library<a class="headerlink"
                                                                    href="#Understanding-the-goal-of-the-library"
                                                                    title="Link to this heading">#</a></h1>
                        <p>The functioning of a tool is usually easier to grasp when its utility and purpose are made
                            plain. I’ll therefore start with a brief wrap-up of our project goals. As explained in the
                            <code class="docutils literal notranslate"><span class="pre">README.md</span></code> and on
                            our <a class="reference external"
                                   href="https://mromanello.github.io/ajax-multi-commentary/">webpage</a>, our main goal
                            is to create a dynamic interface to query, display and compare classical commentaries. To
                            this purpose, we rely on a single source of data: scanned images of commentaries. To go all
                            the way from images to
                            information extraction, we will have to complete several steps :</p>
                        <ol class="arabic simple">
                            <li><p><strong>AjmcImage processing</strong> aims at preparing and enhancing our images.</p>
                            </li>
                            <li><p><strong>OCR</strong> then converts the images to machine-readable text.</p></li>
                            <li><p><strong>OLR</strong> performs layout analysis to extract the regions we are
                                interested in.</p></li>
                            <li><p><strong>Alignment</strong> maps single comments to the snippet of text they are
                                actually commenting.</p></li>
                            <li><p><strong>NLP</strong> extract meaningful information from these comments.</p></li>
                        </ol>
                        <section id="From-goal-to-code">
                            <h2>From goal to code<a class="headerlink" href="#From-goal-to-code"
                                                    title="Link to this heading">#</a></h2>
                            <p>How do these steps translate into code ? You may have seen that each of the
                                aforementioned steps has a directory in <code class="docutils literal notranslate"><span
                                        class="pre">ajmc/</span></code>. These step-oriented directory are called
                                <strong>task-specific</strong> directories. This being said, you may also have seen two
                                exceptions: 1. First, as we generally could get good quality scans, we take image
                                processing for granted. There are only a few helpers for binarization which can be found
                                in <code class="docutils literal notranslate"><span class="pre">commons/image.py</span></code>.
                                2. Secondly, there are two directories <code class="docutils literal notranslate"><span
                                        class="pre">ajmc/</span></code> which do not
                                correspond directly to any steps mentioned above : <code
                                        class="docutils literal notranslate"><span
                                        class="pre">ajmc/commons</span></code> and <code
                                        class="docutils literal notranslate"><span
                                        class="pre">ajmc/text_processing</span></code>.</p>
                            <p>It would be too long to go through all the task-specific directories. For a general
                                understanding of the code, it is better to start with <code
                                        class="docutils literal notranslate"><span class="pre">commons</span></code> and
                                <code class="docutils literal notranslate"><span
                                        class="pre">text_processing</span></code>, as these two are massively used by
                                each task.</p>
                        </section>
                    </section>
                    <section id="The-commons-directory">
                        <h1>The commons directory<a class="headerlink" href="#The-commons-directory"
                                                    title="Link to this heading">#</a></h1>
                        <p>TODO include commons.__init__ in the docs</p>
                    </section>
                    <section id="The-text_processing-directory">
                        <h1>The <code class="docutils literal notranslate"><span
                                class="pre">text_processing</span></code> directory<a class="headerlink"
                                                                                      href="#The-text_processing-directory"
                                                                                      title="Link to this heading">#</a>
                        </h1>
                        <p>The meaning of “<em>text</em> processing” in <code class="docutils literal notranslate"><span
                                class="pre">ajmc/text_processing</span></code> is not to be confused with (natural) <em>language</em>
                            processing in <code class="docutils literal notranslate"><span
                                    class="pre">ajmc/nlp</span></code>. As a matter of fact <code
                                    class="docutils literal notranslate"><span class="pre">text_processing</span></code>
                            doesn’t deal with NLP at all. It allows for the manipulation source texts (generally OCR
                            outputs) and exports them to different formats for later use. For a more detailed view of
                            our text pipeline, please check <code class="docutils literal notranslate"><span
                                    class="pre">/notebooks/commentary_importation_pipeline.ipynb</span></code>. Its most
                            important function is to unify the diversity of
                            OCR output formats in a single canonical json.</p>
                        <p>There are therefore three types of objects in <code
                                class="docutils literal notranslate"><span class="pre">text_processing</span></code>: 1.
                            Ocr objects, which can be found in <code class="docutils literal notranslate"><span
                                    class="pre">text_processing/ocr_classes/</span></code> and which deal with OCR
                            output files. 2. Canonical objects, which can unsurprisingly be found in <code
                                    class="docutils literal notranslate"><span class="pre">text_processing/canonical_classes</span></code>
                            and deal with the canonical format jsons. 3. Generic objects, can be found in <code
                                    class="docutils literal notranslate"><span class="pre">text_processing/generic_classes</span></code>.
                            They are abstract object which determine methods and properties used by both canonical and
                            ocr objects.</p>
                        <p>All these objects have some common attributes, but also particularities due to their nature
                            and also to the level of text containers they represent. Indeed, both <code
                                    class="docutils literal notranslate"><span class="pre">Ocr-</span></code> and <code
                                    class="docutils literal notranslate"><span class="pre">Canonical-</span></code>
                            objects can represent various levels of text containers commentaries, pages, page regions,
                            lines and words. We hence end up with the following classes :</p>
                        <p>All these object inherit from commons ancestor, <code
                                class="docutils literal notranslate"><span class="pre">TextContainer</span></code>. The
                            detailed scheme of inheritance can be seen below :</p>
                        <div class="table-wrapper docutils container">
                            <table class="docutils align-default">
                                <thead>
                                <tr class="row-odd">
                                    <th class="head"><p>Level</p></th>
                                    <th class="head"><p>Generic</p></th>
                                    <th class="head"><p>Canonical</p></th>
                                    <th class="head"><p>Ocr</p></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr class="row-even">
                                    <td><p>Text container (abstract)</p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">TextContainer</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span class="pre">CanonicalTextContainer</span></code>
                                    </p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">OcrTextContainer</span></code></p></td>
                                </tr>
                                <tr class="row-odd">
                                    <td><p>Commentary</p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">Commentary</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span class="pre">CanonicalCommentary</span></code>
                                    </p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">OcrCommentary</span></code></p></td>
                                </tr>
                                <tr class="row-even">
                                    <td><p>Page</p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">Page</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">CanonicalPage</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">OcrPage</span></code></p></td>
                                </tr>
                                <tr class="row-odd">
                                    <td><p>Region</p></td>
                                    <td></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">CanonicalRegion</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span class="pre">OcrRegion</span></code>
                                    </p></td>
                                </tr>
                                <tr class="row-even">
                                    <td><p>Line</p></td>
                                    <td></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">CanonicalLine</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">OcrLine</span></code></p></td>
                                </tr>
                                <tr class="row-odd">
                                    <td><p>Word</p></td>
                                    <td></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">CanonicalWord</span></code></p></td>
                                    <td><p><code class="docutils literal notranslate"><span
                                            class="pre">OcrWord</span></code></p></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <img alt="Main classes inheritance" src="docs/images/classes_inheritance.png"/>
                        <p><strong>Note</strong>. The choice of going for multiple objects is motivated by the fact that
                            each object behaves in a slightly different way depending on its source and level. Though
                            this structure may seem complicated, it is the results of several explorations (single
                            classes with type- or level-conditioned functions, no inheritance…) and appeared to be the
                            best balance between conflicting design principles such as systematicity, simplicity,
                            efficiency and maintanibility.</p>
                        <p>Both canonical and ocr objects have specific attributes in the nitty-gritty of which we will
                            not enter here. Let us all review the most common and important attributes and methods.</p>
                        <p>Each object must implement a method to call it’s direct parents and children. Note that
                            “parent” and “children” do not refer to the inheritance of python objects here. Rather, they
                            refer to the inclusion of textual objects within each other. Hence, when I say that a <code
                                    class="docutils literal notranslate"><span class="pre">Line</span></code> counts
                            among a <code class="docutils literal notranslate"><span class="pre">Page</span></code>’s
                            “children”, I do <strong>not</strong> mean that <code
                                    class="docutils literal notranslate"><span class="pre">-Line</span></code> objects
                            are child-classes of <code class="docutils literal notranslate"><span
                                    class="pre">-Page</span></code> objects. Similarly, a <code
                                    class="docutils literal notranslate"><span class="pre">Region</span></code>-level
                            object must be able to call its parent <code class="docutils literal notranslate"><span
                                    class="pre">Page</span></code> and its children lines. The
                            grammar for this is <code class="docutils literal notranslate"><span class="pre">TextContainer.parents.level</span></code>
                            or <code class="docutils literal notranslate"><span class="pre">TextCoontainer.children.level[+s]</span></code>.
                            Notice the singular for parents (eg. <code class="docutils literal notranslate"><span
                                    class="pre">self.parents.page</span></code>) and the plural for children (e.g. <code
                                    class="docutils literal notranslate"><span
                                    class="pre">self.children.pages</span></code>, reflecting the fact that <code
                                    class="docutils literal notranslate"><span
                                    class="pre">OcrLine.parent.page</span></code> returns a single <code
                                    class="docutils literal notranslate"><span class="pre">OcrPage</span></code>,
                            whereas <code class="docutils literal notranslate"><span class="pre">OcrCommentary.children.pages</span></code>
                            returns a list of <code class="docutils literal notranslate"><span
                                    class="pre">OcrPage</span></code>s. Under the hood, <code
                                    class="docutils literal notranslate"><span class="pre">children</span></code> and
                            <code class="docutils literal notranslate"><span class="pre">parent</span></code> call <code
                                    class="docutils literal notranslate"><span
                                    class="pre">self._get_children(self,</span> <span class="pre">children_type)</span></code>
                            and
                            <code class="docutils literal notranslate"><span class="pre">self._get_parents(self,</span>
                                <span class="pre">parent_type)</span></code> respectively. Every <code
                                    class="docutils literal notranslate"><span class="pre">TextContainer</span></code>
                            must implement these methods.</p>
                        <p>This system allows for a very fluid navigation between the elements of commentaries, and
                            turns complex queries (e.g. getting all the potentially abbreviated words in all the
                            footnotes of a commentary) into relatively simple one liner (in our case <code
                                    class="docutils literal notranslate"><span class="pre">[w</span> <span class="pre">for</span>
                                <span class="pre">r</span> <span class="pre">in</span> <span class="pre">commentary.children.regions</span>
                                <span class="pre">if</span> <span class="pre">r.region_type</span> <span
                                        class="pre">==</span> <span class="pre">&quot;footnote&quot;</span> <span
                                        class="pre">for</span> <span class="pre">w</span> <span class="pre">in</span>
                                <span class="pre">r.children.words</span> <span class="pre">if</span> <span class="pre">w.text.endswith('.')]</span></code>).
                        </p>
                        <p><code class="docutils literal notranslate"><span class="pre">Page</span></code> level object
                            have a direct link to their image, stored as an <code
                                    class="docutils literal notranslate"><span
                                    class="pre">ajmc.commons.image.AjmcImage</span></code> and part of the <code
                                    class="docutils literal notranslate"><span
                                    class="pre">Commentary.images</span></code> list of all page images. As for regions,
                            lines and words, there image corresponds to the page image cropped to their bounding box.
                            <code class="docutils literal notranslate"><span class="pre">Commentary</span></code> is a
                            special, as it contains multiple images. It therefore comes a <code
                                    class="docutils literal notranslate"><span class="pre">self.images</span></code>
                            attribute, which is equivalent to <code class="docutils literal notranslate"><span
                                    class="pre">[page.image</span> <span class="pre">for</span> <span
                                    class="pre">page</span> <span class="pre">in</span> <span class="pre">self.children.pages]</span></code>.
                        </p>
                        <p>Each text <code class="docutils literal notranslate"><span
                                class="pre">TextContainer</span></code> below <code
                                class="docutils literal notranslate"><span class="pre">Commentary</span></code>-level
                            has a single <code class="docutils literal notranslate"><span
                                    class="pre">self.bbox</span></code> attribute representing its bounding box, i.e.
                            the minimal rectangle around the object’s words. From a python perspective, <code
                                    class="docutils literal notranslate"><span class="pre">self.bbox</span></code> as a
                            <code class="docutils literal notranslate"><span
                                    class="pre">ajmc.commons.geometry.Shape</span></code>.</p>
                        <p>Finally, every <code class="docutils literal notranslate"><span
                                class="pre">TextContainer</span></code> has a <code
                                class="docutils literal notranslate"><span class="pre">self.text</span></code>
                            attribute, which results from the concatenation of the text contained by its word.</p>
                        <p>All these attributes can add up to relatively heavy computations. To keep object
                            instantiation light and swift, <code class="docutils literal notranslate"><span class="pre">lazy_objects.lazy_property</span></code>
                            is the default way to create an object’s attribute. <code
                                    class="docutils literal notranslate"><span class="pre">lazy_property</span></code>
                            is a decorator which allows for computing and storing properties only when they are called.
                            When first created, objects should require no computation at all. This explains the
                            inheritance based <code class="docutils literal notranslate"><span
                                    class="pre">__init__</span></code> system: each text container should expect only
                            required arguments and (almost)
                            nothing happens at <code class="docutils literal notranslate"><span
                                    class="pre">__init__</span></code> time.</p>
                    </section>

                </article>
            </div>
            <footer>

                <div class="related-pages">
                    <a class="next-page" href="contributing_guidelines.html">
                        <div class="page-info">
                            <div class="context">
                                <span>Next</span>
                            </div>
                            <div class="title">Contributing guidelines</div>
                        </div>
                        <svg class="furo-related-icon">
                            <use href="#svg-arrow-right"></use>
                        </svg>
                    </a>
                    <a class="prev-page" href="data_organisation.html">
                        <svg class="furo-related-icon">
                            <use href="#svg-arrow-right"></use>
                        </svg>
                        <div class="page-info">
                            <div class="context">
                                <span>Previous</span>
                            </div>

                            <div class="title">Understanding the ajmc directory structure.</div>

                        </div>
                    </a>
                </div>
                <div class="bottom-of-page">
                    <div class="left-details">
                        <div class="copyright">
                            Copyright &#169; 2023, Sven Najem-Meyer
                        </div>
                        Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link"
                                                                                          href="https://pradyunsg.me">@pradyunsg</a>'s

                        <a href="https://github.com/pradyunsg/furo">Furo</a>

                    </div>
                    <div class="right-details">

                    </div>
                </div>

            </footer>
        </div>
        <aside class="toc-drawer">


            <div class="toc-sticky toc-scroll">
                <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
                </div>
                <div class="toc-tree-container">
                    <div class="toc-tree">
                        <ul>
                            <li><a class="reference internal" href="#">Understanding the goal of the library</a>
                                <ul>
                                    <li><a class="reference internal" href="#From-goal-to-code">From goal to code</a>
                                    </li>
                                </ul>
                            </li>
                            <li><a class="reference internal" href="#The-commons-directory">The commons directory</a>
                            </li>
                            <li><a class="reference internal" href="#The-text_processing-directory">The <code
                                    class="docutils literal notranslate"><span class="pre">text_processing</span></code>
                                directory</a></li>
                        </ul>

                    </div>
                </div>
            </div>


        </aside>
    </div>
</div>
<script src="../_static/documentation_options.js?v=2fea6348"></script>
<script src="../_static/doctools.js?v=888ff710"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/scripts/furo.js?v=32e29ea5"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
        src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>
    window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}
</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>